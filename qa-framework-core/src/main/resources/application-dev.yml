spring:
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:5433/qa_framework
    username: qauser
    password: qapass
    hikari:
      maximum-pool-size: 10
      minimum-idle: 2
      connection-timeout: 20000

  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true

  flyway:
    enabled: true
    baseline-on-migrate: true
    validate-on-migrate: false
    locations: classpath:db/migration


# Local file storage configuration
storage:
  type: local
  base-path: ${user.home}/qa-framework/artifacts
  screenshots: ${storage.base-path}/screenshots
  videos: ${storage.base-path}/videos
  logs: ${storage.base-path}/logs
  reports: ${storage.base-path}/reports
  retention-days: 30
  max-file-size-mb: 10
  allowed-extensions:
    - png
    - jpg
    - jpeg
    - txt
    - log
    - html
    - json
    - mp4
  cleanup:
    enabled: true
    schedule: "0 0 2 * * *"

# Selenium configuration
selenium:
  grid-url: http://${SELENIUM_HOST:localhost}:4444/wd/hub
  implicit-wait: 10
  page-load-timeout: 30

#logging:
  #level:
   # com.company.qa: DEBUG
    #org.hibernate.SQL: DEBUG

# Add to existing application-dev.yml

# Security configuration
security:
  api-key:
    header-name: X-API-Key
    rate-limit:
      enabled: true
      requests-per-minute: 100
    logging:
      enabled: true

logging:
  level:
    root: INFO
    com.company.qa: DEBUG
    com.company.qa.security: DEBUG  # ADD THIS
    org.springframework.security: DEBUG  # ADD THIS (for troubleshooting)
    com.framework.qa.service: DEBUG
    com.framework.qa.integration.jira: DEBUG
    com.company.qa.service.ai: DEBUG

execution:
  timeout-minutes: 10
  max-concurrent: 3
  retry:
    enabled: true
    max-attempts: 2
    delay-seconds: 5
    retry-on-timeout: true
    retry-on-network-error: true
    retry-on-assertion-failure: false


scheduling:
  enabled: true

# Add to existing application-dev.yml (keep everything else)

# Notification configuration
notification:
  enabled: true
  async: true
  retry:
    enabled: true
    max-attempts: 3
    delay-seconds: 10
  rate-limit:
    enabled: true
    max-per-minute: 10

  # Email configuration
  email:
    enabled: true
    from: qa-framework@company.com
    smtp:
      host: smtp.gmail.com
      port: 587
      username: ${EMAIL_USERNAME:your-email@gmail.com}
      password: ${EMAIL_PASSWORD:your-app-password}
      auth: true
      starttls: true

  # Slack configuration
  slack:
    enabled: true
    webhook-url: ${SLACK_WEBHOOK_URL:https://hooks.slack.com/services/YOUR/WEBHOOK/URL}
    channel: '#qa-alerts'
    username: 'QA Framework Bot'
    icon-emoji: ':robot_face:'

  # Webhook configuration
  webhook:
    enabled: true
    default-url: ${WEBHOOK_URL:http://localhost:8080/api/v1/webhooks/default}
    timeout-seconds: 10

# Update Spring Mail configuration

  mail:
    host: ${notification.email.smtp.host}
    port: ${notification.email.smtp.port}
    username: ${notification.email.smtp.username}
    password: ${notification.email.smtp.password}
    properties:
      mail:
        smtp:
          auth: ${notification.email.smtp.auth}
          starttls:
            enable: ${notification.email.smtp.starttls}

ai:
  enabled: true
  provider: ${AI_PROVIDER:mock}  # mock, bedrock, or ollama

  bedrock:
    enabled: ${AI_BEDROCK_ENABLED:true}
    region: ${AWS_REGION:us-east-1}
    access-key-id: ${AWS_ACCESS_KEY_ID:}
    secret-access-key: ${AWS_SECRET_ACCESS_KEY:}
    model:  amazon.nova-pro-v1:0                 #us.amazon.nova-micro-v1:0  # Was: anthropic.claude-3-sonnet-...
    max-tokens: 8000
    temperature: 0.7
    timeout: 120

  #test-generation:
    #quality:
      #minimum-score: 60.0
    #cost:
     # max-per-test-usd: 0.50
     # max-daily-usd: 1.00
    #retry:
      #max-attempts: 3
    #draft-folder: /tmp/qa-framework/drafts
   # committed-folder: src/test/resources/features


  test-generation:
    # Output paths
    #draft-folder: /tmp/qa-framework/drafts
    #committed-folder: /tmp/qa-framework/tests/src/test
    draft-folder: "${user.home}/qa-framework/tests/AiDraft"
    committed-folder: "${user.home}/qa-framework/tests/committed"

    # Quality thresholds
    quality:
      minimum-score: 60.0
      auto-approve-threshold: 90.0
      confidence-threshold: HIGH

    # Cost controls
    cost:
      max-per-test-usd: 0.50
      daily-limit-usd: 1.00
      alert-threshold-usd: 1.00

    # Retry configuration
    retry:
      max-attempts: 3
      backoff-multiplier: 2
      initial-delay-ms: 1000

    # Template configuration
    templates:
      cucumber-feature: "classpath:templates/cucumber-feature.ftl"
      cucumber-steps: "classpath:templates/cucumber-steps.ftl"
      page-object: "classpath:templates/page-object.ftl"
      testng-test: "classpath:templates/testng-test.ftl"



  # ADD THIS SECTION
  ollama:
    enabled: ${OLLAMA_ENABLED:true}
    base-url: ${OLLAMA_BASE_URL:http://localhost:11434}
    model: ${OLLAMA_MODEL:llama3.2:latest"}
    max-tokens: 4096
    temperature: 0.7
    timeout-seconds: 120


data:
  redis:
    host: localhost
    port: 6379
    repositories:
      enabled: true  # Disable Redis repositories since we only use Redis for caching

log:
  request:
    mode: hybrid    # postgres | eventbridge | hybrid

aws:
  eventbridge:
    enabled: true
    bus-name: qa-framework-audit-bus
    source: qa-framework.api

jira:
  secrets:
    enabled: true
    region: us-east-1
    secret-name: prod/jira/qa-bot
  base-url: https://singh24honey.atlassian.net
  project-key: SCRUM
  rate-limit:
    enabled: true
    requests-per-minute: 60

git:
  enabled: true
  secrets:
    enabled: false
  working-directory: /tmp/qa-framework-test/git-workspace

# ============================================================
# PLAYWRIGHT - DEVELOPMENT OVERRIDES
# ============================================================
playwright:
  browser: firefox
  headless: false      # See browser during development
  slow-mo: 100         # Slow down to see actions (100ms)
  record-video: true   # Record videos for debugging
  record-trace: true   # Capture traces
  timeout: 60000       # Longer timeout for debugging (60 sec)


# Agent Configuration
agent:
  memory:
    ttl-hours: 24
    key-prefix: "agent:context:"

  execution:
    default-max-iterations: 20
    default-max-cost: 5.0
    approval-timeout-seconds: 3600
